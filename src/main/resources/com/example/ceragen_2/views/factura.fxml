<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Text?>

<VBox xmlns:fx="http://javafx.com/fxml"
      fx:controller="com.example.ceragen_2.controller.FacturaController"
      spacing="0" styleClass="content-area"
      stylesheets="@../css/styles.css">
    <padding>
        <Insets bottom="40.0" left="40.0" right="40.0" top="40.0"/>
    </padding>

    <TabPane fx:id="tabPane" tabClosingPolicy="UNAVAILABLE" VBox.vgrow="ALWAYS" styleClass="content-area">
        <Tab text="Listar">

        </Tab>
        <Tab text="Nueva">
            <ScrollPane fitToWidth="true">
                <!-- Card contenedor principal -->
                <VBox  spacing="15" style="-fx-padding: 20;">

                    <!-- Encabezado CERAGEN 2 -->
                    <Text fx:id="txtTituloFacturaNueva" text="CERAGEN 2" styleClass="title-xl" style="-fx-text-alignment: center;"/>

                    <!-- Número de Factura -->
                    <Text fx:id="txtNumeroFacturaNueva" text="Factura N° XXXXXX" styleClass="subtitle" style="-fx-font-size: 16px; -fx-text-alignment: center;"/>

                    <!-- Primera fila: Fecha y Ciudad -->
                    <HBox spacing="20" alignment="CENTER">
                        <HBox spacing="10" HBox.hgrow="ALWAYS">
                            <Label text="Fecha de realización:" styleClass="text-primary-dark-control" minWidth="150"/>
                            <TextField fx:id="txtFechaRealizacionFacturaNueva" HBox.hgrow="ALWAYS"/>
                            <!-- editable="true" styleClass="disabled-field" -->
                        </HBox>

                        <HBox spacing="10" HBox.hgrow="ALWAYS">
                            <Label text="Ciudad:" styleClass="text-primary-dark-control" minWidth="100"/>
                            <TextField fx:id="txtCiudadFacturaNueva" HBox.hgrow="ALWAYS"/>
                        </HBox>
                    </HBox>

                    <!-- Segunda fila: Cliente y Cédula -->
                    <HBox spacing="20" alignment="CENTER">
                        <HBox spacing="10" HBox.hgrow="ALWAYS">
                            <Label text="Cliente:" styleClass="text-primary-dark-control" minWidth="150"/>
                            <ComboBox fx:id="cmbClienteFacturaNueva" prefWidth="150"/>
                        </HBox>
                    </HBox>

                    <!-- Botón para agregar cita -->
                    <HBox spacing="20" alignment="CENTER_LEFT" style="-fx-padding: 10 0;">
                        <Button text="Agregar Cita" onAction="#handleModal"
                                styleClass="btn, btn-success"
                                style="-fx-pref-width: 150; -fx-pref-height: 35;"/>
                    </HBox>

                    <!-- Tabla de CITAS -->
                    <TableView fx:id="tableCitasFactura" styleClass="table-view" prefHeight="250" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colCitaPaciente" text="Paciente" prefWidth="200"/>
                            <TableColumn fx:id="colCitaProfesional" text="Profesional" prefWidth="200"/>
                            <TableColumn fx:id="colCitaFecha" text="Fecha y Hora" prefWidth="150"/>
                            <TableColumn fx:id="colCitaMotivo" text="Motivo" prefWidth="250"/>
                            <TableColumn fx:id="colCitaCosto" text="Costo" prefWidth="100"/>
                            <TableColumn fx:id="colCitaAcciones" text="Acciones" prefWidth="100"/>
                        </columns>
                        <placeholder>
                            <Label text="No hay citas agregadas. Haga clic en 'Agregar Cita'." styleClass="text-neutral-medium"/>
                        </placeholder>
                    </TableView>

                    <!-- Resumen financiero -->
                    <HBox spacing="20" alignment="CENTER_RIGHT" style="-fx-padding: 10 0 0 0;">
                        <HBox spacing="10">
                            <Label text="Subtotal:" styleClass="text-primary-dark-control"/>
                            <TextField fx:id="txtSubtotalFacturaNueva" editable="false" prefWidth="150"/>
                        </HBox>

                        <Label text="..." styleClass="text-primary-dark-control"/>

                        <HBox spacing="10">
                            <Label text="IVA:" styleClass="text-primary-dark-control"/>
                            <TextField fx:id="txtIvaFacturaNueva" editable="false" prefWidth="150"/>
                        </HBox>
                    </HBox>

                    <HBox spacing="20" alignment="CENTER_RIGHT" style="-fx-padding: 10 0 0 0;">
                        <HBox spacing="10">
                            <Label text="Descuento:" styleClass="text-primary-dark-control"/>
                            <TextField fx:id="txtDescuentoFacturaNueva" editable="false" prefWidth="150"/>
                        </HBox>

                        <HBox spacing="10">
                            <Label text="Método de pago:" styleClass="text-primary-dark-control"/>
                            <ComboBox fx:id="cmbMetodoPagoFacturaNueva" prefWidth="150"/>
                        </HBox>
                    </HBox>

                    <!-- Total a pagar -->
                    <HBox spacing="10" alignment="CENTER_RIGHT">
                        <Label text="Total a pagar:" styleClass="text-primary-dark-control" style="-fx-font-weight: bold; -fx-font-size: 16px;"/>
                        <TextField fx:id="txtTotalFacturaNueva" editable="false" styleClass="disabled-field"
                                   style="-fx-font-weight: bold; -fx-font-size: 16px;" prefWidth="150"/>
                    </HBox>

                    <!-- Botones de acción -->
                    <HBox spacing="15" alignment="CENTER" style="-fx-padding: 20 0 0 0;">
                        <Button fx:id="btnGuardarNuevaFactura" text="Guardar"
                                styleClass="btn, btn-primary" onAction="#handleCrearFactura"
                                style="-fx-pref-width: 150; -fx-pref-height: 40;"/>
                        <Button fx:id="btnCancelarNuevaFactura" text="Cancelar"
                                styleClass="btn, btn-danger"
                                style="-fx-pref-width: 150; -fx-pref-height: 40;"/>
                    </HBox>
                </VBox>
            </ScrollPane>
        </Tab>
        <Tab text="Ver">
            <VBox spacing="15" style="-fx-padding: 20;">

                <!-- Encabezado CERAGEN 2 -->
                <Text text="CERAGEN 2" styleClass="title-xl" style="-fx-text-alignment: center;"/>

                <!-- Número de Factura -->
                <Text fx:id="txtFacturaNumero" text="Factura N° XXXXXX" styleClass="subtitle" style="-fx-font-size: 16px; -fx-text-alignment: center;"/>

                <!-- Primera fila: Fecha y Ciudad -->
                <HBox spacing="20" alignment="CENTER">
                    <HBox spacing="10" HBox.hgrow="ALWAYS">
                        <Label text="Fecha de realización:" styleClass="text-primary-dark-control" minWidth="150"/>
                        <TextField fx:id="txtFechaRealizacion" editable="false" styleClass="disabled-field" HBox.hgrow="ALWAYS"/>
                    </HBox>

                    <HBox spacing="10" HBox.hgrow="ALWAYS">
                        <Label text="Ciudad:" styleClass="text-primary-dark-control" minWidth="100"/>
                        <TextField fx:id="txtCiudad" editable="false" styleClass="disabled-field" HBox.hgrow="ALWAYS"/>
                    </HBox>
                </HBox>

                <!-- Segunda fila: Cliente y Cédula -->
                <HBox spacing="20" alignment="CENTER">
                    <HBox spacing="10" HBox.hgrow="ALWAYS">
                        <Label text="Cliente:" styleClass="text-primary-dark-control" minWidth="150"/>
                        <TextField fx:id="txtCliente" editable="false" styleClass="disabled-field" HBox.hgrow="ALWAYS"/>
                    </HBox>

                    <HBox spacing="10" HBox.hgrow="ALWAYS">
                        <Label text="N° de cédula:" styleClass="text-primary-dark-control" minWidth="100"/>
                        <TextField fx:id="txtCedula" editable="false" styleClass="disabled-field" HBox.hgrow="ALWAYS"/>
                    </HBox>
                </HBox>

                <!-- Tercera fila: Teléfono y Dirección -->
                <HBox spacing="20" alignment="CENTER">
                    <HBox spacing="10" HBox.hgrow="ALWAYS">
                        <Label text="N° de teléfono:" styleClass="text-primary-dark-control" minWidth="150"/>
                        <TextField fx:id="txtTelefono" editable="false" styleClass="disabled-field" HBox.hgrow="ALWAYS"/>
                    </HBox>

                    <HBox spacing="10" HBox.hgrow="ALWAYS">
                        <Label text="Dirección domiciliaria:" styleClass="text-primary-dark-control" minWidth="100"/>
                        <TextField fx:id="txtDireccion" editable="false" styleClass="disabled-field" HBox.hgrow="ALWAYS"/>
                    </HBox>
                </HBox>

                <!-- Tabla de productos/servicios -->
                <TableView fx:id="tableProducts" prefHeight="250" styleClass="table-view">
                    <columns>
                        <TableColumn fx:id="colProducto" text="Producto/Servicio" prefWidth="350"/>
                        <TableColumn fx:id="colPrecio" text="Precio" prefWidth="150"/>
                        <TableColumn fx:id="colCantidad" text="Cantidad" prefWidth="150"/>
                        <TableColumn fx:id="colTotal" text="Total" prefWidth="150"/>
                    </columns>
                    <placeholder>
                        <Label text="Tabla sin contenido" styleClass="text-neutral-medium"/>
                    </placeholder>
                </TableView>

                <!-- Resumen financiero -->
                <HBox spacing="20" alignment="CENTER_RIGHT" style="-fx-padding: 10 0 0 0;">
                    <HBox spacing="10">
                        <Label text="Subtotal:" styleClass="text-primary-dark-control"/>
                        <TextField fx:id="txtSubtotal" editable="false" styleClass="disabled-field" prefWidth="150"/>
                    </HBox>

                    <Label text="..." styleClass="text-primary-dark-control"/>

                    <HBox spacing="10">
                        <Label text="IVA:" styleClass="text-primary-dark-control"/>
                        <TextField fx:id="txtIva" editable="false" styleClass="disabled-field" prefWidth="150"/>
                    </HBox>
                </HBox>

                <HBox spacing="20" alignment="CENTER_RIGHT" style="-fx-padding: 10 0 0 0;">
                    <HBox spacing="10">
                        <Label text="Descuento:" styleClass="text-primary-dark-control"/>
                        <TextField fx:id="txtDescuento" editable="false" prefWidth="150"/>
                    </HBox>

                    <HBox spacing="10">
                        <Label text="Método de pago:" styleClass="text-primary-dark-control"/>
                        <TextField fx:id="txtMetodoPago" editable="false" prefWidth="150"/>
                    </HBox>
                </HBox>

                <!-- Total a pagar -->
                <HBox spacing="10" alignment="CENTER_RIGHT">
                    <Label text="Total a pagar:" styleClass="text-primary-dark-control" style="-fx-font-weight: bold; -fx-font-size: 16px;"/>
                    <TextField fx:id="txtTotal" editable="false" styleClass="disabled-field"
                               style="-fx-font-weight: bold; -fx-font-size: 16px;" prefWidth="150"/>
                </HBox>

                <!-- Botones de acción -->
                <HBox spacing="15" alignment="CENTER" style="-fx-padding: 20 0 0 0;">
                    <Button fx:id="btnVolver" text="Volver"
                            styleClass="btn, btn-secondary"
                            style="-fx-pref-width: 150; -fx-pref-height: 40;"/>
                    <Button fx:id="btnAnular" text="Anular"
                            styleClass="btn, btn-danger"
                            style="-fx-pref-width: 150; -fx-pref-height: 40;"/>
                </HBox>
            </VBox>

        </Tab>

    </TabPane>

</VBox>